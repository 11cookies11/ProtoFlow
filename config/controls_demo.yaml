version: 1

vars:
  target_voltage: 0
  target_enable: false
  target_mode: ""

channels:
  demo:
    type: dummy  # no real connection needed

ui:
  controls:
    - id: tx_params
      title: "TX Parameters"
      separate: true
      inputs:
        - { name: voltage, label: Voltage, type: float, min: 0, max: 24, step: 0.1, default: 12.0 }
        - { name: enable, label: Enable, type: bool, default: true }
        - { name: mode, label: Mode, type: select, options: [A, B, C], default: A }
      actions:
        apply: { emit: ui.param.apply }

state_machine:
  initial: wait_input
  states:
    wait_input:
      do:
        - log: "waiting for ui.param.apply ..."
      on_event:
        ui.param.apply: apply_params

    apply_params:
      do:
        - set:
            target_voltage: "$event.voltage"
            target_enable: "$event.enable"
            target_mode: "$event.mode"
        - log: "applied: V=$target_voltage, enable=$target_enable, mode=$target_mode"
      goto: wait_input
